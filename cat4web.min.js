function CAT4Web(){function n(){var n=new XMLHttpRequest;n.open("POST","https://cat4web.r8acc.ru/licence/request",!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&(200===n.status?o("token",JSON.parse(n.responseText)):(u.close(),console.log("Could not get access key. Send mail to i@r8acc.ru.")))},n.send()}function e(){c.onDisconnect(),s&&(s=!1,setTimeout(function(){c.connect()},c.reconnectTimeout))}function t(n){var e=JSON.parse(n.data);if(!0===e.auth)i=!0,c.onConnect();else switch(e.type){case"rig-number":r=null!==e.value?parseInt(e.value):null,c.onChangeRigNumber(r);break;case"status":a=null!==e.value?parseInt(e.value):null,c.onChangeStatus(a);break;case"freq":l=null!==e.value?parseInt(e.value):null,c.onChangeFrequency(l);break;case"mode":h=null!==e.value?parseInt(e.value):null,c.onChangeMode(h);break;case"ptt":f=!!e.value,c.onChangePTT(f)}}function o(n,e){s&&u.send(n+"="+e)}this.MODE_CW_U=8388608,this.MODE_CW_L=16777216,this.MODE_SSB_U=33554432,this.MODE_SSB_L=67108864,this.MODE_DIG_U=134217728,this.MODE_DIG_L=268435456,this.MODE_AM=536870912,this.MODE_FM=1073741824,this.STATUS_NOTCONFIGURED=0,this.STATUS_DISABLED=1,this.STATUS_PORTBUSY=2,this.STATUS_NOTRESPONDING=3,this.STATUS_ONLINE=4,this.reconnectTimeout=5e3;var u=null,s=!1,i=!1,c=this,r=null,a=null,l=null,h=null,f=!1;this.onConnect=function(){},this.onDisconnect=function(){},this.onChangeRigNumber=function(n){},this.onChangeStatus=function(n){},this.onChangeFrequency=function(n){},this.onChangeMode=function(n){},this.onChangePTT=function(n){},this.isActive=function(){return i},this.getRigNumber=function(){return r},this.setRigNumber=function(n){o("rig-number",n)},this.getStatus=function(){return a},this.getFrequency=function(){return l},this.setFrequency=function(n){l=n,o("freq",n)},this.getMode=function(){return h},this.setMode=function(n){o("mode",n)},this.getPTT=function(){return f},this.connect=function(){return"function"!=typeof WebSocket?(console.log("WebSocket not supported for you. Sorry."),!1):!s&&(s=!0,u=new WebSocket("ws://127.0.0.1:34469"),u.onopen=n,u.onclose=e,u.onmessage=t,!0)},this.disconnect=function(){return s=i=!1,!!u&&(u.close(),!0)}}
